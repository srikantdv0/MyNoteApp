@page "/note";
@using Microsoft.AspNetCore.Authorization;

@using NotesBlaze.Components;

<style>
    .full-width {
        width: 100%;
        height: 80vh;
    }
</style>
@if (noteContentForm == null)
{
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
}
else
{
<EditForm Model="@noteContentForm" Context="formContext">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <textarea @bind="@noteContentForm.Title" />
    <textarea @bind="@noteContentForm.Content" class="full-width" />
    <button type="Submit" class="btn btn-primary" @onclick="@(()=>Submit())" hidden="@hideUpdateBtn">Update</button>
    <button class="btn btn-primary" @onclick="@(()=>Reset())" hidden="@hideDeleteBtn">Delete</button>
    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight" hidden="@hideShareBtn" @onclick="@(()=> OnBoardShareItem())">Share</button>
    <button class="btn btn-primary" @onclick="@(()=>Unsubscribe())" hidden="@hideUnsubscribeBtn">Unsubscribe</button>
    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRightInfo" aria-controls="offcanvasRight">Info</button>
</EditForm>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
        <div class="offcanvas-header">
            <h5 id="offcanvasRightLabel">Share</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <p>@noteContentForm.Title</p>
            <ShareWith />
        </div>
    </div>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRightInfo" aria-labelledby="offcanvasRightLabel">
        <div class="offcanvas-header">
            <h5 id="offcanvasRightLabel">About</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <td>Note Title</td>
                        <td>@stateContainer?.noteId?.Title</td>
                    </tr>
                    <tr>
                        <td>Created DTS</td>
                        <td>@stateContainer?.noteId?.CreatedDTS.ToLocalTime()</td>
                    </tr>
                    <tr>
                        <td>Last Modified DTS</td>
                        <td>@stateContainer?.noteId?.ModifiedDTS?.ToLocalTime()</td>
                    </tr>
                    <tr>
                        <td>Modified by</td>
                        <td>@stateContainer?.noteId?.ModifiedByName</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
}

